---
title: MySQL Performance Optimization
layout: posts
categories: Mysql
---

# MySQL 性能优化
    此处不谈论mysql缓存，由于表的数据经常变动导致缓存失效   
    
## index - 索引
* 主键
* 唯一索引
* 普通索引
* 唯一复合索引
* 复合索引

---

    对于数据量很大的表，查询时性能很慢，这时候首先想到的就是建立索引。   
    建立索引的列尽可能的是查询条件对应的列，索引列值应当给个非空值（空值会放弃索引）。   
    复合索引尽可能让常用列放在最前边，即最左原则  
    
    
## count(*) - 统计总数
    针对大数据表，一般分页查询的时候获取前几页速度都是很快的，当获取前几页数据响应很慢时，通常是获取总页数的时候
    比较慢，当数据量比较多的时候，且某些条件没有对应的索引，则mysql就会进行全表扫描，导致获取总个数花费数十秒甚至数分钟。   
    此时可以考虑将分页查询接口拆开：
    * 查询数据接口
    * 查询分页信息接口
    同时程序自身缓存查询结果，采取增量查询的方式：
    * 缓存当前条数以及最后一条数据ID
    * 查询时，仅须查询大于当前ID数据的条数 + 缓存条数即为总条数
---

## 增量查询
    假设历史数据一般不会轻易变动查询条件项。
    此时查询优化可以通过增量查询的方式进行查询：
    * 缓存上一次查询结果，及最后一条数据ID
    * 通过查询大于上次最后一条ID结果的数据与上次结果作合并得到最终结果
    
    如果历史数据变动但是不频繁：
    * 同上
    * 对于每次变动，将变动的信息与缓存信息作合并